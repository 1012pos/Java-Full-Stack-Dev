20240801
1. https://mariadb.com/kb/en/create-function/ 참조

2. SQL에서 직접 함수를 만들수도 있고, 내장된 함수를 사용할 수 도 있다.
직접 만들때는(사용자 함수) 보편적으로 f를 사용해서 명시한다.

3. DELIMITER(MariaDB 문법)
: 여러줄의 SQL문을 합쳐줄수 있다.

4. 사용자 함수란, 직접 본인이 함수를 만들어서 사용하는 함수
-- 전체 수를 구하는 사용자 함수(대상 테이블은 t_menu)
DELIMITER $$
CREATE FUNCTION f_event1() RETURNS INT
BEGIN
	DECLARE f_out int;
	SELECT COUNT(가격) INTO f_out FROM t_menu;
	RETURN f_out;
END;
$$
DELIMITER ;

5. 





USE edu;

SELECT * FROM t_menu;

SELECT 종류, SUM(가격) AS 합 FROM t_menu GROUP BY 종류;

-- DROP FUNCTION f_event1;

-- 전체 수를 구하는 사용자 함수(대상 테이블은 t_menu)
DELIMITER $$
CREATE FUNCTION f_event1() RETURNS INT
BEGIN
	DECLARE f_out int;
	SELECT COUNT(가격) INTO f_out FROM t_menu;
	RETURN f_out;
END;
$$
DELIMITER ;

SELECT f_event1();
SELECT COUNT(가격) FROM t_menu;

-- 두개의 수를 받아서 합한 수를 받는 사용자 함수
CREATE FUNCTION f_event2(IN a INT, IN b INT) RETURNS INT
RETURN(a + b);


SELECT f_event2(2,5);


-- 성별 데이터를 시각화 하기 위해서 변경 해주는 사용자 함수
CREATE TABLE u (
	nm VARCHAR(10),
	gender BOOLEAN
);

INSERT INTO u VALUES ('홍길동', 1);
INSERT INTO u VALUES ('류관순', 0);

COMMIT;


delimiter $$
CREATE FUNCTION f_event3(IN f_gender BOOLEAN) RETURNS VARCHAR(20)
BEGIN
	DECLARE r_gender VARCHAR(20);
	if(f_gender = 0) then
		RETURN '여성';
	ELSE
		RETURN '남성';
	END if;
END;
$$
delimiter ;

SELECT nm, gender, f_event3(gender) FROM u;

SELECT NOW(), DATE_FORMAT(NOW(), '%Y년%m월%d일') AS 한국식날짜;

SELECT f_event4(NOW()) AS 현재날짜, 
       f_event4(STR_TO_DATE('2023-07-29', '%Y-%m-%d')) AS 작년날짜,
       f_event4(STR_TO_DATE('2024-06-09', '%Y-%m-%d')) AS 지난달날짜;

CREATE FUNCTION f_event4(IN f_date datetime) RETURNS VARCHAR(30)
RETURN DATE_FORMAT(f_date, '%Y년%m월%d일');
